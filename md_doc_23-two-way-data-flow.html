<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Live Cells C++: 3. Two-Way Data Flow</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Live Cells C++
   </div>
   <div id="projectbrief">Reactive Programming for C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_doc_23-two-way-data-flow.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">3. Two-Way Data Flow</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md17"></a> In all the examples we've seen till this point, data always flows in a single direction. Now we'll introduce two-way data flow which allows data to flow in both directions between a pair of cells.</p>
<h1><a class="anchor" id="autotoc_md18"></a>
Mutable Computed Cells</h1>
<p>A <em>mutable computed cell</em> is a cell which ordinarily functions like a normal computed cell, created with <code><a class="el" href="namespacelive__cells.html#a38ef71dbf501d266974a7fae279a8441">live_cells::computed()</a></code>, but can also have its value set directly as though it is a mutable cell. When the value of a mutable computed cell is set, it <em>reverses</em> the computation by setting the argument cells to a value such that when the mutable computed cell is recomputed, the same value will be produced as the value that was set. This allows data to flow in two directions, whereas <code><a class="el" href="namespacelive__cells.html#a38ef71dbf501d266974a7fae279a8441">live_cells::computed()</a></code> only allows data to flow in a single direction.</p>
<p>Mutable computed cells are created using <code><a class="el" href="namespacelive__cells.html#a69ebc62a1450860b4aeeac16af2c0d9e">live_cells::mutable_computed()</a></code>, which takes the computation function and reverse computation function. The computation function computes the cell's value as a function of argument cells, like <code><a class="el" href="namespacelive__cells.html#a38ef71dbf501d266974a7fae279a8441">live_cells::computed()</a></code>. The reverse computation function <em>reverses</em> the computation by assigning a value to the argument cells. It is given the value that was assigned to the cell.</p>
<p>Example:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> a = <a class="code hl_function" href="namespacelive__cells.html#ab365650aeb27f61f31622a49d4fb79a3">live_cells::variable</a>(0);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> str_a = <a class="code hl_function" href="namespacelive__cells.html#a69ebc62a1450860b4aeeac16af2c0d9e">live_cells::mutable_computed</a>([=] {</div>
<div class="line">    <span class="keywordflow">return</span> std::to_string(a())</div>
<div class="line">}, [=] (value) {</div>
<div class="line">  a.value(std::stoi(value));</div>
<div class="line">});</div>
<div class="ttc" id="anamespacelive__cells_html_a69ebc62a1450860b4aeeac16af2c0d9e"><div class="ttname"><a href="namespacelive__cells.html#a69ebc62a1450860b4aeeac16af2c0d9e">live_cells::mutable_computed</a></div><div class="ttdeci">auto mutable_computed(F &amp;&amp;fn, R &amp;&amp;reverse)</div><div class="ttdef"><b>Definition</b> mutable_computed.hpp:55</div></div>
<div class="ttc" id="anamespacelive__cells_html_ab365650aeb27f61f31622a49d4fb79a3"><div class="ttname"><a href="namespacelive__cells.html#ab365650aeb27f61f31622a49d4fb79a3">live_cells::variable</a></div><div class="ttdeci">mutable_cell&lt; T &gt; variable(T value)</div><div class="ttdef"><b>Definition</b> mutable_cell.hpp:244</div></div>
</div><!-- fragment --><p>The mutable computed cell <code>str_a</code> converts the value of its argument cell <code>a</code> to a string. When the value of <code>str_a</code> is set:</p>
<ol type="1">
<li>An <code>int</code> is parsed from the value.</li>
<li>The value of <code>a</code> is set to the parsed <code>int</code> value.</li>
</ol>
<div class="fragment"><div class="line">str_a.value(<span class="stringliteral">&#39;100&#39;</span>);</div>
<div class="line">std::cout &lt;&lt; (a.value() + 1) &lt;&lt; std::endl; <span class="comment">// Prints: 101</span></div>
</div><!-- fragment --><p>This definition is useful for obtaining string input from the user and converting it to an integer. The string input, can be assigned directly to the <code>str_a</code> cell, and the parsed integer can be observed by observing <code>a</code>.</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> watcher = live_cells::watch([=] {</div>
<div class="line">    std::cout &lt;&lt; (a.value() + 1) &lt;&lt; std::endl;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Prints: 16</span></div>
<div class="line">str_a.value(15);</div>
</div><!-- fragment --><p>The value of this is that data can also flow from <code>a</code> to <code>str_a</code>:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> watcher = live_cells::watch([=] {</div>
<div class="line">    std::cout &lt;&lt; str_a.value() &lt;&lt; std::endl;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Prints: 7</span></div>
<div class="line">a.value(7);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md19"></a>
Multiple Arguments</h1>
<p>Mutable computed cells can be defined as a function of more than one argument cell. For example we can define a <code>sum</code> cell, that ordinarily computes the sum of two numbers held in cells <code>a</code> and <code>b</code>. When <code>sum</code> is assigned a value, <code>a</code> and <code>b</code> are set to one half of the sum that was assigned.</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> a = <a class="code hl_function" href="namespacelive__cells.html#ab365650aeb27f61f31622a49d4fb79a3">live_cells::variable</a>(0.0);</div>
<div class="line"><span class="keyword">auto</span> b = <a class="code hl_function" href="namespacelive__cells.html#ab365650aeb27f61f31622a49d4fb79a3">live_cells::variable</a>(0.0);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> sum = <a class="code hl_function" href="namespacelive__cells.html#a69ebc62a1450860b4aeeac16af2c0d9e">live_cells::mutable_computed</a>([=] {</div>
<div class="line">    <span class="keywordflow">return</span> a() + b();</div>
<div class="line">}, [=] (sum) {</div>
<div class="line">    <span class="keyword">auto</span> half = sum / 2;</div>
<div class="line"> </div>
<div class="line">    a.value(half);</div>
<div class="line">    b.value(half);</div>
<div class="line">});</div>
</div><!-- fragment --><p>The reverse computation function assigns the sum divided by two to both cells <code>a</code> and <code>b</code>.</p>
<p>For example setting <code>sum</code> to <code>6</code> results in <code>a</code> and <code>b</code> both being set to <code>3</code>:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> watcher = live_cells::watch([=] {</div>
<div class="line">    std::cout &lt;&lt; a() &lt;&lt; <span class="stringliteral">&quot; + &quot;</span> &lt;&lt; b();</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; sum() &lt;&lt; std::endl;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Prints: 3 + 3 = 6</span></div>
<div class="line">sum.value(6);</div>
</div><!-- fragment --><p>The value of <code>a</code> and <code>b</code> can still be set in which case, <code>sum</code> computes the sum of the values that were set:</p>
<div class="fragment"><div class="line"><span class="comment">// Prints: 4 + 3 =7</span></div>
<div class="line">a.value(4);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Prints: 4 + 10 = 14</span></div>
<div class="line">b.value(10);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
